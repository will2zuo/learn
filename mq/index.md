### 主流消息队列（MQ）对比表

| **特性**               | RabbitMQ                | Apache Kafka            | ActiveMQ                 | RocketMQ                | Amazon SQS              | NATS                     |
|-------------------------|-------------------------|--------------------------|--------------------------|-------------------------|-------------------------|--------------------------|
| **协议支持**            | AMQP, STOMP, MQTT       | 自定义协议（TCP）        | JMS, AMQP, STOMP         | 自定义协议（TCP）       | HTTP/HTTPS (REST API)   | NATS, NATS Streaming     |
| **消息模型**            | 队列、发布-订阅         | 发布-订阅（分区日志）    | 队列、发布-订阅          | 队列、发布-订阅         | 队列                    | 发布-订阅、请求-响应     |
| **持久化**              | 内存/磁盘               | 磁盘（顺序写入）         | 内存/磁盘                | 磁盘                   | 云端存储（托管）        | 内存（可选磁盘持久化）  |
| **吞吐量**              | 中（万级/秒）           | **高**（百万级/秒）      | 中低（万级/秒）          | **高**（十万级/秒）     | 中（受限于 AWS 扩展）   | **超高**（百万级/秒）    |
| **延迟**                | 低（毫秒级）            | 中高（依赖批量处理）     | 低（毫秒级）             | 低（毫秒级）           | 中（100ms~）            | **极低**（微秒级）       |
| **事务支持**            | ✅（插件）              | ✅（Exactly-Once 语义）  | ✅（JMS 事务）           | ✅（事务消息机制）      | ❌                       | ❌                       |
| **顺序性保证**          | ❌                      | ✅（分区内严格有序）     | ❌                       | ✅（队列严格有序）      | ❌                       | ✅（NATS Streaming）     |
| **高可用性**            | 镜像队列、集群          | 副本机制（ISR）          | 主从架构                 | 多副本、分布式架构      | 托管（AWS 多可用区）    | 集群（Raft 共识）        |
| **扩展性**              | 垂直扩展                | **水平扩展**（分区）     | 垂直扩展                 | **水平扩展**           | 自动扩展（AWS 托管）    | 水平扩展                 |
| **管理界面**            | ✅（Web UI）            | ✅（第三方工具）         | ✅（Web UI）             | ✅（Dashboard）         | ✅（AWS 控制台）         | ❌                       |
| **社区/生态**           | **活跃**（Erlang 生态） | **极活跃**（大数据生态） | 中（Apache 项目）        | 活跃（阿里云生态）      | 托管（AWS 生态）        | 中（CNCF 项目）          |
| **适用场景**            | 企业级异步通信          | 实时日志流、大数据管道   | 传统 JMS 应用            | 电商高并发、金融交易    | 云原生解耦、削峰填谷    | IoT、微服务低延迟通信    |

---

### **关键特性说明**
1. **吞吐量**  
   - **Kafka**：适用于海量数据流（如日志采集），吞吐量受分区数量影响。  
   - **RocketMQ**：阿里双11验证的高并发场景，支持事务消息和顺序消息。  
   - **NATS**：基于内存的极低延迟，适合高频消息（如游戏、IoT）。

2. **持久化与可靠性**  
   - **RabbitMQ**：通过镜像队列保证高可用，但性能损耗较大。  
   - **Kafka**：数据持久化到磁盘，支持多副本（ISR 机制）。  
   - **Amazon SQS**：完全托管，但消息最长保留14天。

3. **事务与一致性**  
   - **Kafka**：支持 Exactly-Once 语义（需配置事务ID）。  
   - **RocketMQ**：通过半消息（Half Message）实现分布式事务。  
   - **RabbitMQ**：需通过插件（如 `rabbitmq-stream`）支持事务。

4. **云原生支持**  
   - **Amazon SQS**：无缝集成 AWS Lambda、S3 等服务。  
   - **Kafka**：云厂商提供托管服务（如 Confluent Cloud、AWS MSK）。  
   - **NATS**：轻量级，适合边缘计算和容器化部署。

5. **延迟敏感场景**  
   - **NATS**：微秒级延迟，适合实时通信（如股票行情）。  
   - **RabbitMQ**：毫秒级延迟，适合传统企业应用。

---

### **选型建议**
- **大数据流处理**：Apache Kafka（日志、事件流）  
- **金融级高可靠**：RocketMQ（事务消息、顺序性）  
- **企业级通用场景**：RabbitMQ（灵活协议支持）  
- **云原生 Serverless**：Amazon SQS（无运维成本）  
- **超低延迟通信**：NATS（IoT、实时微服务）  
